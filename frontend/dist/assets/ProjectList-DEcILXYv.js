import{d as B,u as E,j as l,y as w,z as p,b as t,D as F,t as f,B as j,i as b,c as m,E as N,F as M,C as D,n as $,k as O,p as g,m as U,o as A,r as C}from"./index-BeQ_YpYi.js";import{_ as I}from"./MainLayout.vue_vue_type_script_setup_true_lang-BCk_IIN5.js";import{_ as V}from"./Card.vue_vue_type_script_setup_true_lang-pWITqjj4.js";import{_ as W}from"./Badge.vue_vue_type_script_setup_true_lang-CCLVA0ec.js";import{_ as G}from"./ProgressBar.vue_vue_type_script_setup_true_lang-BKkjWedc.js";import{a as Q,d as S}from"./dayjs.min-Do37gnd9.js";import{c as R}from"./_commonjsHelpers-C4iS2aBk.js";import{_ as q}from"./ProjectModal.vue_vue_type_script_setup_true_lang-BM0zuTNQ.js";import{_ as z}from"./Button.vue_vue_type_script_setup_true_lang-BNsZ58pO.js";import{_ as J}from"./Input.vue_vue_type_script_setup_true_lang-xq1Wb3QM.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Modal-DQYTPExH.js";import"./Select.vue_vue_type_script_setup_true_lang-D-AOEX65.js";var K={exports:{}};(function(c,r){(function(i,a){c.exports=a(Q)})(R,function(i){function a(n){return n&&typeof n=="object"&&"default"in n?n:{default:n}}var _=a(i),d={name:"zh-cn",weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"周日_周一_周二_周三_周四_周五_周六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),ordinal:function(n,h){return h==="W"?n+"周":n+"日"},weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日Ah点mm分",LLLL:"YYYY年M月D日ddddAh点mm分",l:"YYYY/M/D",ll:"YYYY年M月D日",lll:"YYYY年M月D日 HH:mm",llll:"YYYY年M月D日dddd HH:mm"},relativeTime:{future:"%s内",past:"%s前",s:"几秒",m:"1 分钟",mm:"%d 分钟",h:"1 小时",hh:"%d 小时",d:"1 天",dd:"%d 天",M:"1 个月",MM:"%d 个月",y:"1 年",yy:"%d 年"},meridiem:function(n,h){var u=100*n+h;return u<600?"凌晨":u<900?"早上":u<1100?"上午":u<1300?"中午":u<1800?"下午":"晚上"}};return _.default.locale(d,null,!0),d})})(K);const X={class:"pl-4"},Z={class:"mb-3 flex items-start justify-between"},ee={class:"flex-1"},te={class:"flex items-center gap-2"},se={class:"text-lg font-semibold text-secondary-900"},oe={class:"mt-1 text-sm text-secondary-600 line-clamp-2"},ae={class:"mb-3"},le={class:"flex items-center justify-between"},re={class:"flex items-center gap-2"},ne={class:"flex -space-x-2"},ie=["src","alt","title"],ce={key:0,class:"flex h-7 w-7 items-center justify-center rounded-full border-2 border-white bg-secondary-200 text-xs font-medium text-secondary-600"},de={class:"flex items-center gap-3"},ue={class:"text-xs text-secondary-500"},me={key:0,class:"mt-3 flex flex-wrap gap-1.5"},ve=B({__name:"ProjectCard",props:{project:{}},setup(c){S.locale("zh-cn");const r=c,i=O(),a=E(),_=g(()=>a.getUsersByIds(r.project.memberIds)),d=g(()=>_.value.length),n=g(()=>`${S(r.project.startDate).format("MM/DD")} - ${S(r.project.endDate).format("MM/DD")}`),h=g(()=>({planning:"计划中",active:"进行中",completed:"已完成","on-hold":"已暂停"})[r.project.status]),u=g(()=>({planning:"info",active:"primary",completed:"success","on-hold":"warning"})[r.project.status]),L=g(()=>{const x={low:"text-secondary-400",medium:"text-info-500",high:"text-warning-500",critical:"text-danger-500"};return x[r.project.priority]||x.medium}),H=()=>{i.push(`/projects/${r.project.id}`)};return(x,y)=>(l(),w(V,{clickable:!0,onClick:H,class:"relative overflow-hidden"},{default:p(()=>[t("div",{class:"absolute left-0 top-0 bottom-0 w-1.5",style:F({backgroundColor:c.project.color||"#3b82f6"})},null,4),t("div",X,[t("div",Z,[t("div",ee,[t("div",te,[t("h3",se,f(c.project.name),1),j(W,{variant:u.value},{default:p(()=>[b(f(h.value),1)]),_:1},8,["variant"]),(l(),m("svg",{class:N(["h-5 w-5",L.value]),fill:"currentColor",viewBox:"0 0 20 20"},[...y[0]||(y[0]=[t("path",{d:"M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM11 13a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"},null,-1)])],2))]),t("p",oe,f(c.project.description),1)])]),t("div",ae,[j(G,{value:c.project.progress,"show-label":!0},null,8,["value"])]),t("div",le,[t("div",re,[t("div",ne,[(l(!0),m(M,null,D(_.value.slice(0,3),v=>(l(),m("img",{key:v.id,src:v.avatar,alt:v.name,class:"h-7 w-7 rounded-full border-2 border-white",title:v.name},null,8,ie))),128)),d.value>3?(l(),m("div",ce," +"+f(d.value-3),1)):$("",!0)])]),t("div",de,[t("div",ue,[y[1]||(y[1]=t("svg",{class:"mr-1 inline h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),b(" "+f(n.value),1)])])]),c.project.tags&&c.project.tags.length>0?(l(),m("div",me,[(l(!0),m(M,null,D(c.project.tags.slice(0,3),v=>(l(),m("span",{key:v,class:"rounded-full bg-secondary-100 px-2 py-0.5 text-xs text-secondary-600"}," #"+f(v),1))),128))])):$("",!0)])]),_:1}))}}),pe={class:"space-y-6"},_e={class:"flex items-center justify-between"},fe={class:"flex flex-wrap items-center gap-4"},he={class:"flex-1 min-w-[200px]"},xe={class:"flex items-center gap-2"},ye={class:"flex gap-2"},ge=["onClick"],we={key:0,class:"grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3"},je={class:"text-center"},ke={class:"mt-2 text-sm text-secondary-600"},Ne=B({__name:"ProjectList",setup(c){O();const r=U(),i=C(""),a=C([]),_=C(!1),d=C(null),n=o=>{const e=new Date(o.startDate),s=new Date(o.endDate);if(s<e)return 0;let k=0,Y=new Date(e);for(;Y<=s;){const P=Y.getDay();P!==0&&P!==6&&k++,Y.setDate(Y.getDate()+1)}return k*8};A(async()=>{await r.loadProjects();const o=r.projects;for(const e of o)if(!e.estimatedHours||e.estimatedHours===0){const s=n(e);s>0&&await r.updateProject(e.id,{estimatedHours:s})}});const h=[{label:"全部",value:""},{label:"计划中",value:"planning"},{label:"进行中",value:"active"},{label:"已完成",value:"completed"},{label:"已暂停",value:"on-hold"},{label:"废弃",value:"cancelled"}],u=g(()=>{let o=r.projects;if(a.value.length>0&&(o=o.filter(e=>a.value.includes(e.status))),i.value){const e=i.value.toLowerCase();o=o.filter(s=>s.name.toLowerCase().includes(e)||s.description.toLowerCase().includes(e)||s.tags.some(k=>k.toLowerCase().includes(e)))}return o}),L=o=>{if(o==="")a.value=[];else{const e=a.value.indexOf(o);e===-1?a.value.push(o):a.value.splice(e,1)}},H=()=>{i.value="",a.value=[]},x=()=>{y()},y=()=>{d.value=null,_.value=!0},v=()=>{_.value=!1,d.value=null},T=async o=>{if(d.value)await r.updateProject(d.value.id,o);else{const e=await r.createProject(o);console.log("Created project:",e)}};return(o,e)=>(l(),w(I,null,{default:p(()=>[t("div",pe,[t("div",_e,[e[2]||(e[2]=t("div",null,[t("h1",{class:"text-2xl font-bold text-secondary-900"},"项目列表"),t("p",{class:"mt-1 text-sm text-secondary-600"},"管理和查看所有项目")],-1)),j(z,{variant:"primary",onClick:x},{default:p(()=>[...e[1]||(e[1]=[t("svg",{class:"mr-2 h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),b(" 新建项目 ",-1)])]),_:1})]),j(V,{class:"p-4"},{default:p(()=>[t("div",fe,[t("div",he,[j(J,{modelValue:i.value,"onUpdate:modelValue":e[0]||(e[0]=s=>i.value=s),placeholder:"搜索项目...",type:"text"},{prefix:p(()=>[...e[3]||(e[3]=[t("svg",{class:"h-5 w-5 text-secondary-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1)])]),_:1},8,["modelValue"])]),t("div",xe,[e[4]||(e[4]=t("span",{class:"text-sm font-medium text-secondary-700"},"状态:",-1)),t("div",ye,[(l(),m(M,null,D(h,s=>t("button",{key:s.value,onClick:k=>L(s.value),class:N(["rounded-lg px-3 py-1.5 text-sm font-medium transition-colors",a.value.includes(s.value)?"bg-primary-600 text-white":"bg-secondary-100 text-secondary-700 hover:bg-secondary-200"])},f(s.label),11,ge)),64))])]),a.value.length>0||i.value?(l(),w(z,{key:0,variant:"ghost",size:"sm",onClick:H},{default:p(()=>[...e[5]||(e[5]=[b(" 清除筛选 ",-1)])]),_:1})):$("",!0)])]),_:1}),u.value.length>0?(l(),m("div",we,[(l(!0),m(M,null,D(u.value,s=>(l(),w(ve,{key:s.id,project:s},null,8,["project"]))),128))])):(l(),w(V,{key:1,class:"p-12"},{default:p(()=>[t("div",je,[e[7]||(e[7]=t("svg",{class:"mx-auto h-24 w-24 text-secondary-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1",d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})],-1)),e[8]||(e[8]=t("h3",{class:"mt-4 text-lg font-medium text-secondary-900"},"暂无项目",-1)),t("p",ke,f(i.value||a.value.length>0?"没有找到匹配的项目":"开始创建您的第一个项目吧"),1),!i.value&&a.value.length===0?(l(),w(z,{key:0,variant:"primary",class:"mt-4",onClick:y},{default:p(()=>[...e[6]||(e[6]=[b(" 创建项目 ",-1)])]),_:1})):$("",!0)])]),_:1})),j(q,{open:_.value,project:d.value,onClose:v,onSave:T},null,8,["open","project"])])]),_:1}))}});export{Ne as default};
